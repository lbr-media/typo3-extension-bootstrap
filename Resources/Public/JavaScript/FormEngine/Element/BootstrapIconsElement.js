/**
 * @package typo3-extension-bootstrap - Typo3 template extension with Twitter Bootstrap 5 package.
 * @version 1.0.14
 * @author Marcel <mb@lbrmedia.de>
 * @date Mon, 07 Mar 2022 10:37:14 GMT
 * @copyright 2022 LBRmedia
 * @link https://github.com/lbr-media/typo3-extension-bootstrap
 * @license GPL-2.0-or-later
 */
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}define((function(){return function(){function e(t,n){_classCallCheck(this,e);var i=this;this.configurations=JSON.parse(n),this.currentConfiguration=null,this.icons=[],this.currentIconSet="",this.currentValue="",this.currentPosition="",this.currentSize="",this.currentColor="",this.userControlFieldValue=document.getElementById(t+"-hidden"),this.userControlIconSet=document.getElementById(t+"-iconset"),this.userControlValue=document.getElementById(t+"-value"),this.userControlPosition=document.getElementById(t+"-position"),this.userControlSize=document.getElementById(t+"-size"),this.userControlColor=document.getElementById(t+"-color"),this.userControlFilter=document.getElementById(t+"-filter"),this.iconsContainer=document.getElementById(t+"-container"),this.previewContainer=document.getElementById(t+"-icon-preview"),this.removeButton=document.getElementById(t+"-remove"),this.removeButton.addEventListener("click",(function(){i.currentValue="",i.updateValues()})),this.userControlIconSet.addEventListener("change",(function(){i.currentIconSet=i.userControlIconSet.value,i.initIconSet()})),this.userControlPosition&&this.userControlPosition.addEventListener("change",(function(){i.currentPosition=i.userControlPosition.value,i.updateValues()})),this.userControlSize&&this.userControlSize.addEventListener("change",(function(){i.currentSize=i.userControlSize.value,i.updateValues()})),this.userControlColor&&this.userControlColor.addEventListener("change",(function(){i.currentColor=i.userControlColor.value,i.updateValues()})),this.initValues()}return _createClass(e,[{key:"initValues",value:function(){var e=this.userControlFieldValue.value?this.userControlFieldValue.value.split(";"):["","","","",""];this.currentIconSet="string"==typeof e[0]&&"default"!==e[0]?e[0]:"",this.currentValue="string"==typeof e[1]&&"default"!==e[1]?e[1]:"",this.currentPosition="string"==typeof e[2]&&"default"!==e[2]?e[2]:"",this.currentSize="string"==typeof e[3]&&"default"!==e[3]?e[3]:"",this.currentColor="string"==typeof e[4]&&"default"!==e[4]?e[4]:"",this.currentIconSet||"string"==typeof this.configurations[0].key&&(this.currentIconSet=this.configurations[0].key,this.userControlIconSet.value=this.currentIconSet),this.currentValue&&(this.userControlValue.value=this.currentValue,this.createPreviewIcon()),this.currentPosition&&this.userControlPosition&&(this.userControlPosition.value=this.currentPosition),this.currentSize&&this.userControlSize&&(this.userControlSize.value=this.currentSize),this.currentColor&&this.userControlColor&&(this.userControlColor.value=this.currentColor),this.initIconSet()}},{key:"updateValues",value:function(){this.userControlValue.value=this.currentValue,this.userControlFieldValue.value=this.currentIconSet+";"+this.currentValue+";"+this.currentPosition+";"+this.currentSize+";"+this.currentColor,this.createPreviewIcon()}},{key:"initCurrentConfiguration",value:function(){this.currentConfiguration=null;for(var e=0;e<this.configurations.length;e++)if(this.configurations[e].key===this.currentIconSet){this.currentConfiguration=this.configurations[e];break}}},{key:"initIconSet",value:function(){if(this.initCurrentConfiguration(),this.currentConfiguration){for(var e in this.currentConfiguration.includeCss)this.loadStylesheet(this.currentConfiguration.includeCss[e]);this.iconsContainer.innerHTML="loading";var t=this;this.loadContainerHtml(this.currentConfiguration.includeHtml).then((function(e){t.iconsContainer.innerHTML=e,t.initFilter()}))}else console.warn("BootstrapIconsElement: Could not find a configuration for key ".concat(this.currentIconSet))}},{key:"loadStylesheet",value:function(e){for(var t=document.querySelectorAll("link"),n=0;n<t.length;n++)if(t[n].hasAttribute("href")&&t[n].getAttribute("href")===e)return;var i=document.createElement("link");i.href=e,i.type="text/css",i.rel="stylesheet",i.media="all",document.getElementsByTagName("head")[0].appendChild(i)}},{key:"loadContainerHtml",value:function(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onload=function(e){4===i.readyState&&(200===i.status?t(i.response):(n(i),console.error(i.statusText)))},i.send()}))}},{key:"initFilter",value:function(){var e=this;if(this.icons=[],"bsicons"===this.currentConfiguration.key)for(var t=this.iconsContainer.querySelectorAll(".bs-icon"),n=0;n<t.length;n++){var i=[],r="",o=t[n].querySelector(".bs-label");o&&i.push(o.innerHTML.toLowerCase());var s=t[n].querySelector(".bi");s&&(r=s.getAttribute("class").replace("bi ",""),i.push(r.toLowerCase())),i.length&&r&&(this.icons.push({iconElement:t[n],search:i.join(" "),value:r}),t[n].setAttribute("data-bsicon-value",r),t[n].addEventListener("click",(function(t){var n=this.getAttribute("data-bsicon-value");n&&(e.currentValue=n,e.updateValues())})))}this.userControlFilter.addEventListener("keydown",(function(){var t=e.userControlFilter.value.toLowerCase();if(t.trim())for(var n=0;n<e.icons.length;n++)e.icons[n].search.indexOf(t)>-1?e.icons[n].iconElement.style.display="inline-block":e.icons[n].iconElement.style.display="none";else for(var i=0;i<e.icons.length;i++)e.icons[i].iconElement.style.display="inline-block"}))}},{key:"createPreviewIcon",value:function(){if(this.previewContainer.innerHTML="â€“",this.currentValue&&this.currentIconSet&&"bsicons"===this.currentIconSet){this.previewContainer.innerHTML="";var e=document.createElement("i");e.setAttribute("class","bs "+this.currentValue),this.previewContainer.appendChild(e)}}}]),e}()}));