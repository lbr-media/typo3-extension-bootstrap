/**
 * @package typo3-extension-bootstrap - Typo3 template extension with Twitter Bootstrap 5 package.
 * @version 1.0.23
 * @author Marcel <mb@lbrmedia.de>
 * @copyright 2022 LBRmedia
 * @link https://github.com/lbr-media/typo3-extension-bootstrap
 * @license GPL-2.0-or-later
 */
function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}define((function(){return function(){function t(e,n,r){_classCallCheck(this,t);var o=this;if(this.configurations=JSON.parse(n),this.currentConfiguration=null,this.icons=[],this.hooks={},this.allHooksLoaded=!1,this.currentIconSet="",this.currentValue="",this.currentPosition="",this.currentSize="",this.currentColor="",this.userControlFieldValue=document.getElementById(e+"-hidden"),this.userControlIconSet=document.getElementById(e+"-iconset"),this.userControlValue=document.getElementById(e+"-value"),this.userControlPosition=document.getElementById(e+"-position"),this.userControlSize=document.getElementById(e+"-size"),this.userControlColor=document.getElementById(e+"-color"),this.userControlFilter=document.getElementById(e+"-filter"),this.iconsContainer=document.getElementById(e+"-container"),this.previewContainer=document.getElementById(e+"-icon-preview"),this.removeButton=document.getElementById(e+"-remove"),this.removeButton.addEventListener("click",(function(){o.currentValue="",o.updateValues()})),this.userControlIconSet.addEventListener("change",(function(){o.currentIconSet=o.userControlIconSet.value,o.allHooksLoaded&&o.initIconSet()})),this.userControlPosition&&this.userControlPosition.addEventListener("change",(function(){o.currentPosition=o.userControlPosition.value,o.updateValues()})),this.userControlSize&&this.userControlSize.addEventListener("change",(function(){o.currentSize=o.userControlSize.value,o.updateValues()})),this.userControlColor&&this.userControlColor.addEventListener("change",(function(){o.currentColor=o.userControlColor.value,o.updateValues()})),Array.isArray(r))for(var i=function(t){require([r[t]],(function(e){var n=new e(o);o.hooks[n.getKey()]=n,t+1===r.length&&(o.allHooksLoaded=!0,o.initValues())}))},s=0;s<r.length;s++)i(s)}return _createClass(t,[{key:"initValues",value:function(){var t=this.userControlFieldValue.value?this.userControlFieldValue.value.split(";"):["","","","",""];this.currentIconSet="string"==typeof t[0]&&"default"!==t[0]?t[0]:"",this.currentValue="string"==typeof t[1]&&"default"!==t[1]?t[1]:"",this.currentPosition="string"==typeof t[2]&&"default"!==t[2]?t[2]:"",this.currentSize="string"==typeof t[3]&&"default"!==t[3]?t[3]:"",this.currentColor="string"==typeof t[4]&&"default"!==t[4]?t[4]:"",this.currentIconSet?this.userControlIconSet.value=this.currentIconSet:"string"==typeof this.configurations[0].key&&(this.currentIconSet=this.configurations[0].key,this.userControlIconSet.value=this.currentIconSet),this.currentValue&&(this.userControlValue.value=this.currentValue,this.createPreviewIcon()),this.currentPosition&&this.userControlPosition&&(this.userControlPosition.value=this.currentPosition),this.currentSize&&this.userControlSize&&(this.userControlSize.value=this.currentSize),this.currentColor&&this.userControlColor&&(this.userControlColor.value=this.currentColor),this.initIconSet()}},{key:"updateValues",value:function(){this.userControlValue.value=this.currentValue,this.userControlFieldValue.value=this.currentIconSet+";"+this.currentValue+";"+this.currentPosition+";"+this.currentSize+";"+this.currentColor,this.createPreviewIcon()}},{key:"initCurrentConfiguration",value:function(){this.currentConfiguration=null;for(var t=0;t<this.configurations.length;t++)if(this.configurations[t].key===this.currentIconSet){this.currentConfiguration=this.configurations[t];break}}},{key:"initIconSet",value:function(){if(this.initCurrentConfiguration(),this.currentConfiguration){for(var t in this.currentConfiguration.includeCss)this.loadStylesheet(this.currentConfiguration.includeCss[t]);this.iconsContainer.innerHTML="loading";var e=this;this.loadContainerHtml(this.currentConfiguration.includeHtml).then((function(t){e.iconsContainer.innerHTML=t,e.initFilter()}))}else console.warn("BootstrapIconsElement: Could not find a configuration for key ".concat(this.currentIconSet))}},{key:"loadStylesheet",value:function(t){for(var e=document.querySelectorAll("link"),n=0;n<e.length;n++)if(e[n].hasAttribute("href")&&e[n].getAttribute("href")===t)return;var r=document.createElement("link");r.href=t,r.type="text/css",r.rel="stylesheet",r.media="all",document.getElementsByTagName("head")[0].appendChild(r)}},{key:"loadContainerHtml",value:function(t){return new Promise((function(e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.onload=function(t){4===r.readyState&&(200===r.status?e(r.response):(n(r),console.error(r.statusText)))},r.send()}))}},{key:"initFilter",value:function(){var t=this.getCurrentHook();if(t){"function"==typeof t.initFilter?t.initFilter():console.error("Cannot call 'initFilter()' in hook instance for icon set ".concat(this.currentIconSet,"."));var e=this;this.userControlFilter.addEventListener("keydown",(function(){var n=e.userControlFilter.value.toLowerCase().trim();"function"==typeof t.runFilter?t.runFilter(n):console.error("Cannot call 'runFilter()' in hook instance for icon set ".concat(e.currentIconSet,"."))}))}}},{key:"createPreviewIcon",value:function(){if(this.previewContainer.innerHTML="â€“",this.currentValue&&this.currentIconSet){var t=this.getCurrentHook();t&&("function"==typeof t.createPreviewIcon?t.createPreviewIcon():console.error("Cannot call 'createPreviewIcon()' in hook instance for icon set ".concat(this.currentIconSet,".")))}}},{key:"getCurrentHook",value:function(){return this.hooks[this.currentIconSet]||console.error("Cannot get the hook instance for icon set ".concat(this.currentIconSet,".")),this.hooks[this.currentIconSet]}}]),t}()}));