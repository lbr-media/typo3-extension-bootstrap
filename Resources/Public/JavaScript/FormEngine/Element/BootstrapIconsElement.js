/**
 * @package typo3-extension-bootstrap - Typo3 template extension with Twitter Bootstrap 5 package.
 * @version 1.0.15
 * @author Marcel <mb@lbrmedia.de>
 * @date Thu, 10 Mar 2022 17:30:54 GMT
 * @copyright 2022 LBRmedia
 * @link https://github.com/lbr-media/typo3-extension-bootstrap
 * @license GPL-2.0-or-later
 */
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}define((function(){return function(){function e(t,n,r){_classCallCheck(this,e);var o=this;if(this.configurations=JSON.parse(n),this.currentConfiguration=null,this.icons=[],this.hooks={},this.allHooksLoaded=!1,this.currentIconSet="",this.currentValue="",this.currentPosition="",this.currentSize="",this.currentColor="",this.userControlFieldValue=document.getElementById(t+"-hidden"),this.userControlIconSet=document.getElementById(t+"-iconset"),this.userControlValue=document.getElementById(t+"-value"),this.userControlPosition=document.getElementById(t+"-position"),this.userControlSize=document.getElementById(t+"-size"),this.userControlColor=document.getElementById(t+"-color"),this.userControlFilter=document.getElementById(t+"-filter"),this.iconsContainer=document.getElementById(t+"-container"),this.previewContainer=document.getElementById(t+"-icon-preview"),this.removeButton=document.getElementById(t+"-remove"),this.removeButton.addEventListener("click",(function(){o.currentValue="",o.updateValues()})),this.userControlIconSet.addEventListener("change",(function(){o.currentIconSet=o.userControlIconSet.value,o.allHooksLoaded&&o.initIconSet()})),this.userControlPosition&&this.userControlPosition.addEventListener("change",(function(){o.currentPosition=o.userControlPosition.value,o.updateValues()})),this.userControlSize&&this.userControlSize.addEventListener("change",(function(){o.currentSize=o.userControlSize.value,o.updateValues()})),this.userControlColor&&this.userControlColor.addEventListener("change",(function(){o.currentColor=o.userControlColor.value,o.updateValues()})),Array.isArray(r))for(var i=function(e){require([r[e]],(function(t){var n=new t(o);o.hooks[n.getKey()]=n,e+1===r.length&&(o.allHooksLoaded=!0,o.initValues())}))},s=0;s<r.length;s++)i(s)}return _createClass(e,[{key:"initValues",value:function(){var e=this.userControlFieldValue.value?this.userControlFieldValue.value.split(";"):["","","","",""];this.currentIconSet="string"==typeof e[0]&&"default"!==e[0]?e[0]:"",this.currentValue="string"==typeof e[1]&&"default"!==e[1]?e[1]:"",this.currentPosition="string"==typeof e[2]&&"default"!==e[2]?e[2]:"",this.currentSize="string"==typeof e[3]&&"default"!==e[3]?e[3]:"",this.currentColor="string"==typeof e[4]&&"default"!==e[4]?e[4]:"",this.currentIconSet||"string"==typeof this.configurations[0].key&&(this.currentIconSet=this.configurations[0].key,this.userControlIconSet.value=this.currentIconSet),this.currentValue&&(this.userControlValue.value=this.currentValue,this.createPreviewIcon()),this.currentPosition&&this.userControlPosition&&(this.userControlPosition.value=this.currentPosition),this.currentSize&&this.userControlSize&&(this.userControlSize.value=this.currentSize),this.currentColor&&this.userControlColor&&(this.userControlColor.value=this.currentColor),this.initIconSet()}},{key:"updateValues",value:function(){this.userControlValue.value=this.currentValue,this.userControlFieldValue.value=this.currentIconSet+";"+this.currentValue+";"+this.currentPosition+";"+this.currentSize+";"+this.currentColor,this.createPreviewIcon()}},{key:"initCurrentConfiguration",value:function(){this.currentConfiguration=null;for(var e=0;e<this.configurations.length;e++)if(this.configurations[e].key===this.currentIconSet){this.currentConfiguration=this.configurations[e];break}}},{key:"initIconSet",value:function(){if(this.initCurrentConfiguration(),this.currentConfiguration){for(var e in this.currentConfiguration.includeCss)this.loadStylesheet(this.currentConfiguration.includeCss[e]);this.iconsContainer.innerHTML="loading";var t=this;this.loadContainerHtml(this.currentConfiguration.includeHtml).then((function(e){t.iconsContainer.innerHTML=e,t.initFilter()}))}else console.warn("BootstrapIconsElement: Could not find a configuration for key ".concat(this.currentIconSet))}},{key:"loadStylesheet",value:function(e){for(var t=document.querySelectorAll("link"),n=0;n<t.length;n++)if(t[n].hasAttribute("href")&&t[n].getAttribute("href")===e)return;var r=document.createElement("link");r.href=e,r.type="text/css",r.rel="stylesheet",r.media="all",document.getElementsByTagName("head")[0].appendChild(r)}},{key:"loadContainerHtml",value:function(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onload=function(e){4===r.readyState&&(200===r.status?t(r.response):(n(r),console.error(r.statusText)))},r.send()}))}},{key:"initFilter",value:function(){var e=this.getCurrentHook();if(e){"function"==typeof e.initFilter?e.initFilter():console.error("Cannot call 'initFilter()' in hook instance for icon set ".concat(this.currentIconSet,"."));var t=this;this.userControlFilter.addEventListener("keydown",(function(){var n=t.userControlFilter.value.toLowerCase().trim();"function"==typeof e.runFilter?e.runFilter(n):console.error("Cannot call 'runFilter()' in hook instance for icon set ".concat(t.currentIconSet,"."))}))}}},{key:"createPreviewIcon",value:function(){if(this.previewContainer.innerHTML="â€“",this.currentValue&&this.currentIconSet){var e=this.getCurrentHook();e&&("function"==typeof e.createPreviewIcon?e.createPreviewIcon():console.error("Cannot call 'createPreviewIcon()' in hook instance for icon set ".concat(this.currentIconSet,".")))}}},{key:"getCurrentHook",value:function(){return this.hooks[this.currentIconSet]||console.error("Cannot get the hook instance for icon set ".concat(this.currentIconSet,".")),this.hooks[this.currentIconSet]}}]),e}()}));