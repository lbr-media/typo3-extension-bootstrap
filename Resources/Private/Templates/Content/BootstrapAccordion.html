<html
    xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
    xmlns:bs="http://typo3.org/ns/LBRmedia/Bootstrap/ViewHelpers"
    data-namespace-typo3-fluid="true">

<!--
title = Accordion
-->
<f:layout name="Default" />

<f:section name="Main"><f:spaceless>
    <f:if condition="{accordion_items -> f:count}">
        <f:variable name="id" value="accordion-{data.uid}" />
        <f:variable name="keepOpenAttribute"><f:if condition="{accordion.keep_open}"><f:else> data-bs-parent="#{id}"</f:else></f:if></f:variable>
        <div class="accordion" id="{id}">
            <f:for each="{accordion_items}" as="accordionItem">
                <f:render section="_AccordionItem" arguments="{accordionItem:accordionItem, id:id, keepOpenAttribute:keepOpenAttribute}" />
            </f:for>
        </div>
    </f:if>
</f:spaceless></f:section>

<f:section name="_AccordionItem"><f:spaceless>
    <div class="accordion-item">
        <h2 class="accordion-header" id="{id}-{accordionItem.uid}">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#{id}-{accordionItem.uid}-collapse" aria-expanded="{f:if(condition:accordionItem.openedOnLoad, then:'true', else:'false')}" aria-controls="{id}-{accordionItem.uid}-collapse">
                {accordionItem.title}
            </button>
        </h2>
        <div id="{id}-{accordionItem.uid}-collapse" class="accordion-collapse collapse{f:if(condition:accordionItem.openedOnLoad, then:' show')}" aria-labelledby="{id}-{accordionItem.uid}"{keepOpenAttribute -> f:format.raw()}>
            <div class="accordion-body">
                <f:if condition="{accordionItem.contentElements -> f:count()}">
                    <f:for each="{accordionItem.contentElements}" as="contentElement">
                        <f:render section="_ContentElement" arguments="{contentElement:contentElement, id:'{id}-{accordionItem.uid}'}" />
                    </f:for>
                </f:if>
            </div>
        </div>
    </div>
</f:spaceless></f:section>

<f:section name="_ContentElement"><f:spaceless>
    <f:variable name="data" value="{contentElement.data}" />
    <f:variable name="files" value="{contentElement.files}" />
    <f:variable name="grid" value="{contentElement.grid}" />

    <bs:CTypeFrame contentElementData="{data}" idPattern="{id}-###ID###">
        <f:if condition="{grid.header_position}=='above_all'">
            <f:render section="Header" optional="true">
                <f:render partial="Header/All" arguments="{_all}" />
            </f:render>
        </f:if>
        <f:if condition="{files -> f:count()} || {data.bodytext}">
            <f:if condition="{grid.overflow_hidden}"><div class="overflow-hidden"></f:if>
            <div class="{grid.row_classes} {grid.row_space_classes}">
                <f:switch expression="{grid.order}">
                    <f:case value="text_media">
                        <f:if condition="{data.bodytext}"><f:render section="Text" arguments="{_all}" /></f:if>
                        <f:if condition="{files -> f:count()}"><f:render section="Media" arguments="{_all}" /></f:if>
                    </f:case>
                    <f:defaultCase>
                        <f:if condition="{files -> f:count()}"><f:render section="Media" arguments="{_all}" /></f:if>
                        <f:if condition="{data.bodytext}"><f:render section="Text" arguments="{_all}" /></f:if>
                    </f:defaultCase>
                </f:switch>
            </div>
            <f:if condition="{grid.overflow_hidden}"></div></f:if>
        </f:if>
    </bs:CTypeFrame>
</f:spaceless></f:section>

<f:section name="Text">
    <div class="{grid.col_text_classes} {grid.col_space_classes}">
        <f:if condition="{grid.text.item_classes}">
            <f:then>
                <div class="{grid.text.item_classes} h-100">
                    <f:if condition="{grid.header_position}=='text'">
                        <f:render section="Header" optional="true">
                            <f:render partial="Header/All" arguments="{_all}" />
                        </f:render>
                    </f:if>
                    <f:format.html>{data.bodytext}</f:format.html>
                </div>
            </f:then>
            <f:else>
                <f:if condition="{grid.header_position}=='text'">
                    <f:render section="Header" optional="true">
                        <f:render partial="Header/All" arguments="{_all}" />
                    </f:render>
                </f:if>
                <f:format.html>{data.bodytext}</f:format.html>
            </f:else>
        </f:if>
    </div>
</f:section>

<f:section name="Media">
    <div class="{grid.col_media_classes} {grid.col_space_classes}">
        <f:if condition="{grid.media.item_classes}">
            <f:then>
                <div class="{grid.media.item_classes} h-100">
                    <f:if condition="{grid.header_position}=='media'">
                        <f:render section="Header" optional="true">
                            <f:render partial="Header/All" arguments="{_all}" />
                        </f:render>
                    </f:if>
                    <f:render partial="Media/Gallery" arguments="{_all}" />
                </div>
            </f:then>
            <f:else>
                <f:if condition="{grid.header_position}=='media'">
                    <f:render section="Header" optional="true">
                        <f:render partial="Header/All" arguments="{_all}" />
                    </f:render>
                </f:if>
                <f:render partial="Media/Gallery" arguments="{_all}" />
            </f:else>
        </f:if>
    </div>
</f:section>
</html>


